var d,y,V,T,x=-1,v=function(e){addEventListener("pageshow",(function(t){t.persisted&&(x=t.timeStamp,e(t))}),!0)},O=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},E=function(){var e=O();return e&&e.activationStart||0},f=function(e,t){var n=O(),r="navigate";return x>=0?r="back-forward-cache":n&&(document.prerendering||E()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:t===void 0?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},S=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(i){Promise.resolve().then((function(){t(i.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch{}},l=function(e,t,n,r){var i,a;return function(u){t.value>=0&&(u||r)&&((a=t.value-(i||0))||i===void 0)&&(i=t.value,t.delta=a,t.rating=(function(s,o){return s>o[1]?"poor":s>o[0]?"needs-improvement":"good"})(t.value,n),e(t))}},F=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},b=function(e){document.addEventListener("visibilitychange",(function(){document.visibilityState==="hidden"&&e()}))},C=function(e){var t=!1;return function(){t||(e(),t=!0)}},p=-1,D=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},w=function(e){document.visibilityState==="hidden"&&p>-1&&(p=e.type==="visibilitychange"?e.timeStamp:0,z())},A=function(){addEventListener("visibilitychange",w,!0),addEventListener("prerenderingchange",w,!0)},z=function(){removeEventListener("visibilitychange",w,!0),removeEventListener("prerenderingchange",w,!0)},k=function(){return p<0&&(p=D(),A(),v((function(){setTimeout((function(){p=D(),A()}),0)}))),{get firstHiddenTime(){return p}}},L=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},B=[1800,3e3],J=function(e,t){t=t||{},L((function(){var n,r=k(),i=f("FCP"),a=S("paint",(function(u){u.forEach((function(s){s.name==="first-contentful-paint"&&(a.disconnect(),s.startTime<r.firstHiddenTime&&(i.value=Math.max(s.startTime-E(),0),i.entries.push(s),n(!0)))}))}));a&&(n=l(e,i,B,t.reportAllChanges),v((function(u){i=f("FCP"),n=l(e,i,B,t.reportAllChanges),F((function(){i.value=performance.now()-u.timeStamp,n(!0)}))})))}))},I=[.1,.25],G=function(e,t){t=t||{},J(C((function(){var n,r=f("CLS",0),i=0,a=[],u=function(o){o.forEach((function(c){if(!c.hadRecentInput){var W=a[0],j=a[a.length-1];i&&c.startTime-j.startTime<1e3&&c.startTime-W.startTime<5e3?(i+=c.value,a.push(c)):(i=c.value,a=[c])}})),i>r.value&&(r.value=i,r.entries=a,n())},s=S("layout-shift",u);s&&(n=l(e,r,I,t.reportAllChanges),b((function(){u(s.takeRecords()),n(!0)})),v((function(){i=0,r=f("CLS",0),n=l(e,r,I,t.reportAllChanges),F((function(){return n()}))})),setTimeout(n,0))})))},K=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=C(e),document.visibilityState==="hidden"?e():(n=t(e),b(e)),n},M=[2500,4e3],P={},Q=function(e,t){t=t||{},L((function(){var n,r=k(),i=f("LCP"),a=function(o){t.reportAllChanges||(o=o.slice(-1)),o.forEach((function(c){c.startTime<r.firstHiddenTime&&(i.value=Math.max(c.startTime-E(),0),i.entries=[c],n())}))},u=S("largest-contentful-paint",a);if(u){n=l(e,i,M,t.reportAllChanges);var s=C((function(){P[i.id]||(a(u.takeRecords()),u.disconnect(),P[i.id]=!0,n(!0))}));["keydown","click"].forEach((function(o){addEventListener(o,(function(){return K(s)}),{once:!0,capture:!0})})),b(s),v((function(o){i=f("LCP"),n=l(e,i,M,t.reportAllChanges),F((function(){i.value=performance.now()-o.timeStamp,P[i.id]=!0,n(!0)}))}))}}))},H=[800,1800],U=function e(t){document.prerendering?L((function(){return e(t)})):document.readyState!=="complete"?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},X=function(e,t){t=t||{};var n=f("TTFB"),r=l(e,n,H,t.reportAllChanges);U((function(){var i=O();i&&(n.value=Math.max(i.responseStart-E(),0),n.entries=[i],r(!0),v((function(){n=f("TTFB",0),(r=l(e,n,H,t.reportAllChanges))(!0)})))}))},h={passive:!0,capture:!0},Y=new Date,R=function(e,t){d||(d=t,y=e,V=new Date,N(removeEventListener),q())},q=function(){if(y>=0&&y<V-Y){var e={entryType:"first-input",name:d.type,target:d.target,cancelable:d.cancelable,startTime:d.timeStamp,processingStart:d.timeStamp+y};T.forEach((function(t){t(e)})),T=[]}},Z=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;e.type=="pointerdown"?(function(n,r){var i=function(){R(n,r),u()},a=function(){u()},u=function(){removeEventListener("pointerup",i,h),removeEventListener("pointercancel",a,h)};addEventListener("pointerup",i,h),addEventListener("pointercancel",a,h)})(t,e):R(t,e)}},N=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,Z,h)}))},_=[100,300],$=function(e,t){t=t||{},L((function(){var n,r=k(),i=f("FID"),a=function(o){o.startTime<r.firstHiddenTime&&(i.value=o.processingStart-o.startTime,i.entries.push(o),n(!0))},u=function(o){o.forEach(a)},s=S("first-input",u);n=l(e,i,_,t.reportAllChanges),s&&(b(C((function(){u(s.takeRecords()),s.disconnect()}))),v((function(){var o;i=f("FID"),n=l(e,i,_,t.reportAllChanges),T=[],y=-1,d=null,N(addEventListener),o=a,T.push(o),q()})))}))};const ee={CLS:{good:.1,poor:.25},FID:{good:100,poor:300},FCP:{good:1800,poor:3e3},LCP:{good:2500,poor:4e3},TTFB:{good:800,poor:1800}};function g(e,t){const n=ee[e];return!n||t<=n.good?"good":t<=n.poor?"needs-improvement":"poor"}function m(e){typeof window<"u"&&window.gtag&&window.gtag("event",e.name,{event_category:"Web Vitals",value:Math.round(e.name==="CLS"?e.value*1e3:e.value),metric_rating:e.rating,custom_parameter_1:e.id,non_interaction:!0});try{const t=JSON.parse(localStorage.getItem("web-vitals-history")||"[]");t.push({...e,timestamp:Date.now(),url:window.location.pathname}),t.length>50&&t.splice(0,t.length-50),localStorage.setItem("web-vitals-history",JSON.stringify(t))}catch{}}function te(){typeof window>"u"||(G(e=>{const t={name:"CLS",value:e.value,rating:g("CLS",e.value),delta:e.delta,id:e.id,navigationType:performance.getEntriesByType("navigation")[0]?.type||"navigate"};m(t)}),$(e=>{const t={name:"FID",value:e.value,rating:g("FID",e.value),delta:e.delta,id:e.id,navigationType:performance.getEntriesByType("navigation")[0]?.type||"navigate"};m(t)}),J(e=>{const t={name:"FCP",value:e.value,rating:g("FCP",e.value),delta:e.delta,id:e.id,navigationType:performance.getEntriesByType("navigation")[0]?.type||"navigate"};m(t)}),Q(e=>{const t={name:"LCP",value:e.value,rating:g("LCP",e.value),delta:e.delta,id:e.id,navigationType:performance.getEntriesByType("navigation")[0]?.type||"navigate"};m(t)}),X(e=>{const t={name:"TTFB",value:e.value,rating:g("TTFB",e.value),delta:e.delta,id:e.id,navigationType:performance.getEntriesByType("navigation")[0]?.type||"navigate"};m(t)}))}function ne(){if(typeof window>"u")return null;try{const e=JSON.parse(localStorage.getItem("web-vitals-history")||"[]");return e.length===0?null:e.reduce((n,r)=>((!n[r.name]||r.timestamp>n[r.name].timestamp)&&(n[r.name]=r),n),{})}catch{return null}}function re(){if(!(typeof window>"u"||!("PerformanceObserver"in window)))try{new PerformanceObserver(n=>{for(const r of n.getEntries())r.duration>50}).observe({entryTypes:["longtask"]}),new PerformanceObserver(n=>{let r=0;for(const i of n.getEntries())i.hadRecentInput||(r+=i.value);r>.1}).observe({entryTypes:["layout-shift"]})}catch(e){console.warn("Performance Observer not supported or failed to initialize:",e)}}function ie(){if(typeof document>"u")return;["https://fonts.googleapis.com","https://fonts.gstatic.com","https://www.google-analytics.com","https://www.googletagmanager.com"].forEach(n=>{const r=document.createElement("link");r.rel="preconnect",r.href=n,r.crossOrigin="anonymous",document.head.appendChild(r)}),["https://cdnjs.cloudflare.com","https://unpkg.com"].forEach(n=>{const r=document.createElement("link");r.rel="dns-prefetch",r.href=n,document.head.appendChild(r)})}export{ie as addResourceHints,ne as getVitalsSummary,re as initPerformanceObserver,te as initWebVitals};
